{% extends '_base_list.html' %}
{% load i18n static %}
{% block table_search %}{% endblock %}
{% block content_left_head %}<span class="label label-primary">SQL执行记录</span>{% endblock %}
{% block table_container %}
<div id="sqlorderlist">
    <table class="table table-striped table-bordered table-hover " id="sql_table" >
        <thead>
            <tr>
                <th>任务编号</th>
                <th>任务说明</th>
                <th>库名</th>
                <th>是否备份</th>
                <th>提交时间</th>
                <th>提交人</th>
                <th>执行时间</th>
                <th>执行人</th>
                <th>状态</th>
                <th>操作</th>
            </tr>
        </thead>
        <tbody>
          {% for s in sqlexecs %}
            <tr>
                <td>{{s.work_id}}</td>
                <td>{{s.text}}</td>
                <td>{{s.dbinfo}}</td>
                <td>{{s.get_backup_display}}</td>
                <td>{{s.insert_date}}</td>
                <td>{{s.submit_user}}</td>
                <td>{{s.exec_time}}</td>
                <td>{{s.exec_user}}</td>
                {% if s.get_status_display == '未执行' %}
                <td><span class="label label-default">{{s.get_status_display}}</span></td>
                {% elif s.get_status_display == '驳回' %}
                <td><span class="label label-warning">{{s.get_status_display}}</span></td>
                {% elif s.get_status_display == '执行中' %}
                <td><span class="label label-info">{{s.get_status_display}}</span></td>
                {% elif s.get_status_display == '执行成功' %}
                <td><span class="label label-success">{{s.get_status_display}}</span></td>
                {% elif s.get_status_display == '执行失败' %}
                <td><span class="label label-danger">{{s.get_status_display}}</span></td>
                {% endif %}
                <td>
                    <a a href="{% url 'dbops:sqlexecdetail' pk=s.work_id %}" class="btn btn-xs btn-success btn-sql-exec" >详细信息</a>
                </td>
            </tr>
          {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
{% block custom_foot_js %}
    <script>
    </script>
{% endblock %}
